## 整体导图 
**右键保存本地更清晰**

![计网专题png](https://i.loli.net/2021/08/05/ocedlh5iZ2u6Hrm.png)

- 导图加载可能有点慢
- 因为之前笔记都是幕布的不好转markdown  后续会对格式进行逐一修正

## HTTP

### http场景请求

- 请求方式

	- GET--发送请求获取服务器资源
	- POST---向URL指定的资源提交数据
	- PUT--- 修改数据请求
	- DELETE---删除服务器资源
	- HEAD---请求页面的首部 资源的源信息
	- connect ---建立连接隧道
	- options---用于跨域 列出可对资源实行的请求方法
	- TRACE---追踪请求---响应传输路径

- POST和get的区别

	- 参数存放位置不同
	- 请求缓存---get主动被缓存  post除非手动设置
	- 数据包数量可能不同 ---get产生一个tcp数据包 post产生两个
	- 参数数据类型---get只接受ascii    post没有限制
	- 编码形式---get值能进行url编码  post多种编码
	- 安全性---post比get安全
	- 历史记录---get的请求参数会被保存在历史记录中 所以可以作为书签  post不可以

### HTTP状态码

- 常用状态码

	- 1xx：接受的请求正在处理 （信息性状态码）
	- 2xx：表示请求正常处理完毕 （成功状态码）
	- 3xx：表示重定向状态，需要重新请求 （重定向状态码）
	- 4xx：服务器无法处理请求 （客户端错误状态码）
	- 5xx：服务器处理请求出错 （服务端错误状态码）

- 常见状态码

	- 200

		- 成功

	- 301

		- 重定向   请求的旧资源永久被移除了   将会跳转到新的资源

			- 比如 域名迁移后 重定向到新的域名

	- 302

		- 重定向  旧资源还在 但会临时跳转到一个新资源

			- 比如还没登录的时候 去操作 重定向 到登录页面

	- 304

		- 请求资源重定向到缓存中

	- 404

		- 资源未找到  一般是客户端请求了不存在的资源

	- 500

		- 服务器收到请求 但是服务器内部产生了错误

	- 502

		- 连接服务器失败

- 重定向的两种形式

	- 客户端重定向

		- 用户发起请求 初次接到请求的服务器页面无法处理 直接让用户自己去另一个页面请求

			- 比如 办理理财业务的时候走错窗口了 去了社保窗口 只能再到理财业务的窗口

	- 服务端重定向

		- 用户发起请求  初次接到请求的服务器无法处理  去找服务器内部的另一个程序处理 处理后 返回给用户

			- 比如  银行柜台  办理业务  需要经理授权时候  经理会过来进行处理 但是客户本身不用移动窗口

### HTTP是无状态的

- 不保存上下文
- 加上cookie就是给到指定标识 让去理解查找

### HTTP各个版本的区别

- 1.0

	- 浏览器和服务器只能保持短暂的连接   Connection: keep-alive 这个字段开启长连接
	- 每次请求建立TCP连接

- 1.1

	- 引入长连接   TCP连接默认不关闭  可以被复用
	- 引入管道机制  一个TCP里面 可以同时发多个请求
	- 更多的缓存控制策略  如Cache-Control、Etag/If-None-Match等
	- 错误状态处理 （新增了24个错误状态响应码）

- 2.0

	- 多路复用

		- 一个连接里 客户端和浏览器可以同时发送请求或回应  而且不用按照顺序
		- http2 允许服务器未经请求 主动向客户端发送资源

### 实现长连接

- 手动 设置Connection:keep-alive 可以维持链接
- 超时

	- 设置  keep-alive timeout

### http和https

- 区别

	- http明文传输  HTTPs密文传输
	- http  80端口  https  443端口
	- https消耗的资源比http更多

- https的流程

	- 输入https网址，连接443端口
	- 服务器将自己的数字证书 （申请或者自己颁发）（含公钥）发送给客户端
	- 客户端验证数字证书，证书没问题 生成秘钥，用证书的公钥对其加密
	- 客户端发起https中的第二个http请求，将加密后的秘钥发送给服务器
	- 服务器收到客户端密文，用私钥对其进行解密，解密得到客户端发过来的秘钥 KEY，再用KEY对返回数据进行加密 生成密文 VALUE
	- 服务器将密文 VALUE 返回给客户端
	- 客户端 用自己的秘钥解密得到数据

- 数字签名 =  CA(hash（公钥+个人信息))   hash（公钥+个人信息)=信息摘要
- 数字证书 =  公钥 +个人信息+数字签名

### http请求的过程与原理

- 客户端进行DNS域名解析，得到对应的IP地址
- 根据这个IP，找到对应的服务器建立连接（三次握手）
- 建立TCP连接后发起HTTP请求（一个完整的http请求报文）
- 服务器响应HTTP请求，客户端得到html代码
- 客户端解析html代码，用html代码中的资源(如js,css,图片等等)渲染页面。
- 服务器关闭TCP连接（四次挥手）

## TCP

### TCP---三次握手 四次挥手

- TCP三次握手

	- 流程

		- 第一次握手    (SYN=1, seq=x)  客户端进入 SYN_SEND（发送）状态
		- 第二次握手   (SYN=1, ACK=1, seq=y, ACKnum=x+1)    服务器进入SYN_RCV（收到）状态
		- 第三次握手  (ACK=1，ACKnum=y+1)     客户端进入 ESTABLISHED （连接） 状态

	- 为什么是三次

		- 拿面试来说      求职者说：我对公司很满意    公司说：我对你也很满意   求职者说：好的知道了发offer吧
		- 不能是更多次  因为三次足够  不能是量词 无法确定公司和求职者说的求职者是否收到了

- 四次挥手

	- 流程

		- 第一次挥手  (FIN=1，seq=u)   客户端进入  FIN_WAIT_1 （等待）状态
		- 第二次挥手  (ACK=1，ack=u+1,seq =v)   服务器进入  CLOSE_WAIT （关闭等待）状态 客户端收到包后进入 FIN_WAIT_2（等待）状态
		- 第三次挥手    服务器进入  LAST_ACK （最后一个消息）  等待客户端发送
		- 第四次挥手     客户端收到了服务器的关闭请求  发送了确认包   并进入TIME_WAIT状态   等待固定时间（2MSL 2个生命周期）  如果等待期没有收到服务端的数据 则自己进入关闭状态  服务器收到确认包后也进入关闭状态

	- 第四次为什么需要等待2MSL  才进入（保证对端收到了最后的报文）

		- 1个 MSL 保证四次挥手中主动关闭方最后的 ACK 报文能最终到达对端
		- 1个 MSL 保证对端没有收到 ACK 那么进行重传的 FIN 报文能够到达

	- 为什么是四次挥手

		- 拿离职来说     打工人：我要离职了  公司：好的我知道了  我检查一下你有没有啥没有交接的   公司：检查完了 你可以走了  打工人：好的 我走了

### TCP---可靠性

- 连接和断开的可靠性---三次握手四次挥手
- TCP有状态  TCP会记录那些数据被发送了 那些数据被接收那些没被接受  保证数据包按顺序到达
- TCP 可控制    数据包效验  ACK应答   超时重传 等机制

### TCP---和UDP的区别

- TCP 需要先连接  UDP无需建立连接
- TCP要求安全性 可靠性 保证数据不丢失     UDP努力交付 不能保证数据不丢失
- TCP 点对点     UDP一对一 一对多 多对多都可以
- TCP 传输效率低    UDP传输效率高
- TCP适合网页、邮件    UDP适合视频 语音
- TCP面向字节流   UDP面向报文

### TCP---重传

- 默认：超时重传      以时间为准

	- 在发送数据报文时，设定一个定时器，每间隔一段时间，没有收到对方的ACK确认应答报文，就会重发该报文

- 快速重传   以数据为准

	- 前置原理 ： 发送端发送 数据后  服务端返回对应ID的指定数据
	- 在发送过程中 根据返回的值 判断那个地方没有发送成功 进行反复发送  那么就可以判断出是在哪里数据丢失了

- 选择重传  基于快速重传 带选择的重传

## 安全

### 安全---xss攻击

- 类型

	- 储存型   评论区
	- 反射型    q群分享链接
	- 文档型   注入页面  路由劫持

- 概念

	- 攻击者往web页面里面插入恶意html代码

- 解决

	- 对所有输入进行过滤
	- HTML转义
	- 对于链接跳转 要验证内容
	- 限制输入的长度
	- http only

### 安全---csrf攻击

- 攻击方式

	- 自动发GET  POST
	- 利用登录状态

- 解决

	- 检查Referer字段。HTTP头中有一个Referer字段，这个字段用以标明请求来源于哪个地址。
	- 添加校验token
	- 设置sameSite

### 安全---DDOS  DRDOS

- DDOS  常见的ping发送  不同的机器对受害者同时攻击
- DRDOS   发送大量带有被害者IP地址的数据包给攻击主机，然后攻击主机对IP地址源做出大量回应，形成拒绝服务攻击

### 安全--流量劫持

- DNS劫持

	- 篡改DNS 返回不是理论想访问的网站
	- 常见

		- 运营商搞鬼   比如双11红包啥的
		- 电脑中毒

- HTTP劫持

	- HTTPS可以防止
	- 常见网页中出现不该有的广告

## 杂类概念

### 储存---session和cookies

- 定义

	- cookie服务器发送到浏览器 并保存在浏览器本地的小块文本数据   使无状态的HTTP协议记录稳定的状态信息成为了可能
	- session 指的是服务器和客户端一次会话的过程   session利用cookie进行信息处理  用户首次请求后  服务器在浏览器上创建一个cookie 储存session id    session结束了 cookie就过期了

- 不同

	- cookie在客户端  session在服务端
	- cookie 保存ascii  session 可以存任意数据类型
	- cookie一般设置长时间  session有效期较短
	- cookie在客户端  容易被窃取   session不容易
	- cookie 不能超过4k   session 可储存高于cookie

### 浏览器地址栏输入url到显示主页的过程

- DNS解析--查找真正的ip地址
- 与服务器建立TCP连接
- 发送HTTP请求
- 服务器处理请求并返回HTTP报文
- 浏览器解析渲染页面
- 连接结束

### IP地址分类  ABCDE五类

- A类
- A类地址(1~126)：以0开头，网络号占前8位，主机号占后24位。
- B类地址(128~191)：以10开头，网络号占前16位，主机号占后16位。
- C类地址(192~223)：以110开头，网络号占前24位，主机号占后8位。
- D类地址(224~239)：以1110开头，保留位多播地址。
- E类地址(240~255)：以11110开头，保留位为将来使用

### CDN  内容分发网络

- 不使用CDN

	- 杭州用户请求上海      杭州用户-->杭州服务器-->湖南服务器--->湖北服务器--->上海

- 使用CDN

	- 服务器指定了CDN 这个服务商在杭州服务器做了部署 直接访问杭州的即可

- 简单理解

	- 天猫超市 海购外国商品     淘宝发现仓库有直接从对应仓库给发

- 适用情况

	- 不常更新的静态资源
	- 自家服务器资源较少

### 代理和返代理

- 代理

	- 用户知道服务器地址，但是无法访问，通过代理的形式去访问
	- 特点

		- 需要通过 某个软件去访问到代理服务器
		- 访问到原来访问不到的数据
		- 可以对外隐藏用户信息

- 反向代理

	- 用户不知道服务器地址   服务器做处理 将用户分配到对应子服务器
	- 特点

		- 安全
		- 负载均衡

	- 例子

		- 访问淘宝  一开始是总服务器  然后他分配到具体的小服务器 反馈你的请求

### 非对称加密和对称加密

- 对称---加密和解密使用相同密钥的加密算法
- 非对称---前提需要两个密钥（公钥和私钥）   公钥加密后必须用对应的私钥才能解密

## 计算机网络体系结构

![image-20210805185253780](https://i.loli.net/2021/08/05/Qh6IMEVAy5RztaF.png)

### OSI七层模型

- 应用层--为应用程序提供网络服务 （协议HTTP FTP TFTP DNS）
- 表示层---数据的展示、安全（加密解密）、压缩
- 会话层---会话的管理（建立  终止 管理）
- 运输层---管理端到端连接（建立 维护 管理）   TCP UDP协议   数据包离开网卡就进入网络传输层
- 网络层---IP寻址和路由选择     （协议：IPV4 IPV6 ICMP IGMP）
- 数据链路层---控制网络层与物理层之间通信
- 物理层--- 比特流传输     建立、维护、断开物理连接

### TCP/IP 四层模型

- 应用层---为用户提供各种服务 (FTP  DNS SMTP)
- 传输层---为应用层实体提供端到端的通信功能    定义TCP和UDP两层协议
- 网际层---解决主机到主机的通信问题
- 网络接口层---负责监视视距在主机与网络之间的交换

### 五层体系

- 应用层  ---通过应用进程间的交互来完成特定网络应用   协议（DNS HTTP SMTP）
- 传输层--- 负责两台主机进程之间的通信
- 网络层
- 数据链路层
- 物理层

